// Tests for the TextBuilder type.

//-----------------------------------------------------------------------------
// Basic Usage

function testEmpty() {
    var buff = TextBuilder();
    assertEQ(buff.toString(), "");
}

function testAppend() {
    var buff = TextBuilder();
    buff.append("a")
        .append("b")
        .append("c");
    assertEQ(buff.toString(), "abc");
}

function testClear() {
    var buff = TextBuilder();
    buff.append("a")
        .append("b")
        .append("c");
    buff.clear();
    assertEQ(buff.toString(), "");
}

function testPrint() {
    var buff = TextBuilder();
    buff.print("a")
        .print("b")
        .print("c");
    assertEQ(buff.toString(), "abc");
}

function testPrintln() {
    var buff = TextBuilder();
    buff.println("a")
        .println("b")
        .println("c");
    assertEQ(buff.toString(), "a\nb\nc\n");
}

function testPrintf() {
    var buff = TextBuilder();
    buff.printf("%04d", 1);
    assertEQ(buff.toString(), "0001");
}

//-----------------------------------------------------------------------------
// Object Properties

function testFields() {
    var buff = TextBuilder();
    buff.name = "Fred";
    assertEQ(buff.name, "Fred");
}

//-----------------------------------------------------------------------------
// Subclassing

function testSubclass_canExtend() {
    class Buff extends TextBuilder {
        method init(leader) {
            this.leader = leader;
        }
        method fancy(text) {
            this.append(this.leader + text);
        }
    }
    var buff = Buff("+++ ");
    buff.fancy("abc");
    assertEQ(buff.toString(), "+++ abc");
}

function testSubclass_canUseSuper() {
    class Buff extends TextBuilder {
        method println(text) {
            super.println(text);
        }
    }
    var buff = Buff();
    buff.println("abc");
    assertEQ(buff.toString(), "abc\n");
}
